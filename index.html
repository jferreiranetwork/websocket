<!DOCTYPE html>
<html>
<body>
<h2>Controle Relé ESP32</h2>
<button onclick="send('OFF')">Ligar</button>
<button onclick="send('ON')">Desligar</button>
<button onclick="send('PIN:0')">Mudar pino para 2</button>

<script>
// Coloque seu token secreto aqui
const TOKEN = "esp32";

// Conecta ao WebSocket incluindo o token na query string
let ws = new WebSocket(`wss://websocket-vb5m.onrender.com/ws?token=${TOKEN}`, 'echo-protocol');

let isConnected = false;

// Conexão aberta
ws.onopen = () => {
  console.log('Conectado ao WS');
  isConnected = true;
};

// Mensagem recebida
ws.onmessage = (msg) => console.log('Mensagem recebida:', msg.data);

// Função para enviar mensagens somente quando conectado
function send(msg) {
  if (!isConnected) {
    console.log('WebSocket ainda não conectado');
    return;
  }
  ws.send(msg);
}
</script>
</body>
</html>
